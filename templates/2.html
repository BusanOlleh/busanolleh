{% include 'progressbar.html' %}
<!-- FEATURES 1 -->
<div class="page-section">
    <div class="fes1-cont text-center">
        <div id="textBox" class="font-black wow fadeIn box-item">
            ì›í•˜ì‹œëŠ” íƒœê·¸ë¥¼ ì„ íƒí•´ ë³´ì„¸ìš”! ğŸ˜Š
        </div>
        <div class="wow fadeIn" style="display: flex; flex-direction: column; justify-content: center; margin:auto 0;">
            {% set category = ['ì‚¬ì§„ ëª…ì†Œ', 'ìì—°/ê³µì›', 'ë“œë¼ì´ë¸Œ/ì‚°ì±…', 'ì—­ì‚¬/ì¢…êµ/ë¬¸í™” ', 'ì²´í—˜', 'ì¶•ì œ'] %}
            {% set subs = [['ì•¼ê²½', 'ê³„ì ˆ/ê½ƒ', 'í¬í† ì¡´'], ['ë°”ë‹¤', 'ì‚°', 'ê³µì›'],
            ['ë“œë¼ì´ë¸Œ', 'ì‚°ì±…'], ['ì—­ì‚¬', 'ì¢…êµ', 'ë¬¸í™”'], ['ì•¡í‹°ë¹„í‹°', 'ì•„ì´ë™ë°˜', 'ì´ìƒ‰ì²´í—˜'],
            ['ë´„ì¶•ì œ', 'ì—¬ë¦„ì¶•ì œ', 'ê°€ì„ì¶•ì œ', 'ê²¨ìš¸ì¶•ì œ']] %}
            {% for idx1, (i, sub) in enumerate(zip(category, subs)) %}
            <div class="one" style="display:flex; flex-direction: row; align-items: center;">
                <div class="two text-right" style="width: 30%;">
                    <span id="ctg{{idx1+1}}" class="btn-margin ctg">{{ i }}</span>
                </div>
                <div class="three text-left"  style="width: 70%; padding: 0;">
                    {% for idx2, j in enumerate(sub) %}
                    <button id="btn{{idx1+1}}{{idx2}}" class="button medium thin blue btn-margin-2 ctg{{idx1+1}}">{{ j
                        }}</button>
                    {% endfor %}
                </div>
            </div>
            {% endfor %}
        </div>
        <div class="wow fadeIn box-item">
            <button id="nextBtn" class="button medium thin blue btn-margin ">ê²°ê³¼ ë³´ê¸°</button>
            <a id="prevBtn" class="text-underline" href="javascript:window.history.go(-1);">ë’¤ë¡œ ê°€ê¸°</a>
        </div>
    </div>
</div>
</div>
</div>

<!-- JS begin -->
<!-- jQuery  -->
<script src="/static/js/jquery-1.11.2.min.js"></script>

<script type="text/javascript">
// if (sessionStorage.getItem('num')) {
//     var bg_num = sessionStorage.getItem('num');
//     console.log(bg_num);
// }
$('li:eq(0)').addClass("active");

function resize() {
    if (window.innerWidth < window.innerHeight) {
        $('.one').css({'flex-direction': 'column'});
        $('.two').css({'width': '100%'});
        $('.three').css({'width': '100%', 'border-bottom':'rgba(0, 0, 0, 0.4) 0.1vh dot;'});
        $('.two').removeClass('text-right');
        $('.three').addClass('bd-bt');
        $('.three').removeClass('text-left');
        $('.button.medium.thin').addClass('mobile');
        $('.ctg').css({'font-size': '1em', 'padding-right':'0', 'border-right':'rgba(0, 0, 0, 0.4) 0 dashed'});
    } else {
        $('.one').css({'flex-direction': 'row'});
        $('.two').css({'width': '40%'});
        $('.three').css({'width': '60%'});
        $('.two').addClass('text-right');
        $('.three').addClass('text-left');
        $('.ctg').css({'font-size': '2em', 'padding-right':'2vh', 'border-right':'rgba(0, 0, 0, 0.4) 2px dashed'});
        $('.button.medium.thin').removeClass('mobile');
        $('.three').removeClass('bd-bt');
    }
}
resize();
$(window).resize(function () { resize(); });

//ë²„íŠ¼(íƒœê·¸) í´ë¦­ ì´ë²¤íŠ¸ ì²˜ë¦¬
const withEmoji = ['ì‚¬ì§„ ëª…ì†ŒğŸ“¸', 'ìì—°/ê³µì›ğŸŒ»', 'ë“œë¼ì´ë¸Œ/ì‚°ì±…ğŸš¶', 'ì—­ì‚¬/ì¢…êµ/ë¬¸í™” ğŸ›', 'ì²´í—˜ğŸ„', 'ì¶•ì œğŸ†'];
for (const [idx, elem] of withEmoji.entries()) {
    let ctg = "ctg" + [idx + 1];
    let afterInform = false;
    $('.' + ctg).click(function () {
        // if ($(this).text() == 'ì „ì²´') {
        //     $(this).addClass('sub-all');
        //     $(this).siblings().removeClass('active');

        // } else {
        //     $(this).prevAll('.sub-all').removeClass('active');
        // }; 

        if ($(this).hasClass('active')) {
            $(this).removeClass('active');
            if (!$('.' + ctg).hasClass('active')) {
                var innerText = elem.slice(0, -2);
                $('#' + ctg).html(innerText);
            }
        } else {
            $(this).addClass('active');
            $('#' + ctg).html(elem);
        };

        if ($('.button.active').length >= 5){
            $('#textBox').html('íƒœê·¸ë¥¼ ë„ˆë¬´ ë§ì´ ê³ ë¥´ë©´ <br> ê²°ê³¼ê°€ ì •í™•í•˜ì§€ ì•Šì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤ğŸ˜¥');
            afterInform = true;
        }

        if ((afterInform) & ($('.button.active').length < 5)){
            $('#textBox').html('ì¢‹ì•„ìš”! ê²°ê³¼ë¥¼ í™•ì¸í•´ë³¼ê¹Œìš”?');
        }
    });
};
// ê²°ê³¼í˜ì´ì§€ ê°’ ì „ë‹¬ json ver.
// $("#nextBtn").on("click", function () {
//     var tagData = {}
//     $('.button.medium.thin').each(function (index) {
//         if ($(this).hasClass('active')) {
//             if ($(this).text() == 'ì „ì²´') {
//                 $(this).removeClass('active');
//                 $(this).siblings().each(function () {
//                     $(this).addClass('active');
//                 });
//             } else {
//                 let id = $(this).attr('id');
//                 tagData[id] = 1;
//             };
//         } else {
//             if (!($(this).text() == 'ì „ì²´') && !($(this).attr('id') == 'nextBtn')) {
//                 let id = $(this).attr('id');
//                 tagData[id] = 0;
//             };
//         };
//         console.log(tagData);
//     });

//     $.ajax({
//         type: 'POST',
//         contentType: 'application/json',
//         url: '/2',
//         dataType: 'json',
//         data: JSON.stringify(tagData),
// success : function(result) {
//   location.href = ''; 
// },
//     });
// });

// ê²°ê³¼í˜ì´ì§€ ê°’ ì „ë‹¬ string ver.
$("#nextBtn").on("click", function () {
    var tagData = ''
    $('.button.medium.thin').each(function (index) {
        if ($(this).hasClass('active')) {
            if ($(this).text() == 'ì „ì²´') {
                $(this).removeClass('active');
                $(this).siblings().each(function () {
                    $(this).addClass('active');
                });
            } else {
                tagData += 1;
            };
        } else {
            if (!($(this).text() == 'ì „ì²´') && !($(this).attr('id') == 'nextBtn')) {
                tagData += 0;
            };
        };
        sessionStorage.setItem("tag", tagData);
        location.href='/result'
    });
});
</script>